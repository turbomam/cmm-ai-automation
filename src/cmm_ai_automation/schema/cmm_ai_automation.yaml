---
id: https://w3id.org/turbomam/cmm-ai-automation
name: cmm-ai-automation
title: CMM AI Automation Schema
description: |-
  Schema for Critical Mineral Metabolism (CMM) data curation.

  Models microbial strains, growth media, ingredients, and their relationships
  for knowledge graph generation.

license: MIT
see_also:
  - https://turbomam.github.io/cmm-ai-automation

prefixes:
  cmm: https://w3id.org/turbomam/cmm-ai-automation/
  linkml: https://w3id.org/linkml/
  biolink: https://w3id.org/biolink/vocab/
  schema: http://schema.org/
  CHEBI: http://purl.obolibrary.org/obo/CHEBI_
  PUBCHEM.COMPOUND: http://identifiers.org/pubchem.compound/
  CAS: http://identifiers.org/cas/
  KEGG.COMPOUND: http://identifiers.org/kegg.compound/
  MESH: http://identifiers.org/mesh/
  DRUGBANK: http://identifiers.org/drugbank/
  OBI: http://purl.obolibrary.org/obo/OBI_
  UO: http://purl.obolibrary.org/obo/UO_
  RO: http://purl.obolibrary.org/obo/RO_
  NCBITaxon: http://purl.obolibrary.org/obo/NCBITaxon_
  ENVO: http://purl.obolibrary.org/obo/ENVO_
  # Culture collection prefixes
  DSMZ: https://www.dsmz.de/collection/catalogue/details/culture/DSM-
  ATCC: https://www.atcc.org/products/

default_prefix: cmm
default_range: string

imports:
  - linkml:types

# =============================================================================
# CLASSES
# =============================================================================

classes:

  # ---------------------------------------------------------------------------
  # Base classes
  # ---------------------------------------------------------------------------

  NamedThing:
    abstract: true
    description: A generic grouping for any identifiable entity
    slots:
      - id
      - name
      - description
      - synonyms
    class_uri: schema:Thing

  # ---------------------------------------------------------------------------
  # Chemical entities
  # ---------------------------------------------------------------------------

  Ingredient:
    is_a: NamedThing
    description: >-
      A chemical entity that can be a component of solutions or media.
      Represents the abstract ingredient, not a specific instance with concentration.
    slots:
      - chemical_formula
      - chebi_id
      - cas_rn
      - inchikey
      - pubchem_cid
      - xrefs
    id_prefixes:
      - cmm
      - CHEBI

  # ---------------------------------------------------------------------------
  # Mixtures (Solutions and Media)
  # ---------------------------------------------------------------------------

  Mixture:
    abstract: true
    is_a: NamedThing
    description: >-
      Abstract base class for things composed of ingredients.
      Both Solution and GrowthMedium are mixtures.
    slots:
      - has_ingredient_component

  Solution:
    is_a: Mixture
    description: >-
      A pre-made concentrated mixture of ingredients, typically diluted into media.
      Examples: Trace element solution SL-6, Vitamin solution, Phosphate buffer stock.
    slots:
      - solution_type
    id_prefixes:
      - cmm

  GrowthMedium:
    is_a: Mixture
    description: >-
      A complete formulation for cultivating microorganisms.
      Contains ingredients directly and/or pre-made solutions.
    slots:
      - medium_type
      - ph
      - sterilization_method
      - has_solution_component
      - target_organisms
      - references
    id_prefixes:
      - cmm
      - DSMZ
      - ATCC

  # ---------------------------------------------------------------------------
  # Composition relationships (reified)
  # ---------------------------------------------------------------------------

  IngredientComponent:
    description: >-
      Reified relationship: an ingredient as used in a mixture, with concentration and role.
      This captures the context-dependent properties of ingredient usage.
    slots:
      - ingredient
      - concentration_value
      - concentration_unit
      - roles
      - notes
    slot_usage:
      ingredient:
        required: true

  SolutionComponent:
    description: >-
      Reified relationship: a solution as used in a medium, with volume/dilution.
    slots:
      - solution
      - volume_per_liter
      - volume_unit
      - notes
    slot_usage:
      solution:
        required: true

  # ---------------------------------------------------------------------------
  # Enriched Ingredient (for multi-source data integration)
  # ---------------------------------------------------------------------------

  EnrichedIngredient:
    description: >-
      A chemical entity enriched with data from multiple sources.
      Uses (inchikey, cas_rn) tuple as the primary key for entity resolution.
      Each primary API is authoritative for its own ID type:
      - PubChem is authoritative for pubchem_cid
      - ChEBI is authoritative for chebi_id and biological/chemical roles
      - CAS is authoritative for cas_rn
      - MediaDive is authoritative for mediadive_id
    class_uri: biolink:SmallMolecule
    slots:
      - id  # Composite key: {inchikey}|{cas_rn} or generated UUID
      - inchikey  # Part of primary key tuple
      - cas_rn    # Part of primary key tuple
      - name
      - synonyms
      - description
      - chemical_formula
      # Source-specific authoritative IDs
      - chebi_id
      - pubchem_cid
      - mediadive_id
      - kegg_id
      - mesh_id
      - drugbank_id
      # Chemical structure
      - inchi
      - smiles
      # Mass/charge
      - molecular_mass
      - monoisotopic_mass
      - charge
      # Biological annotations from ChEBI (authoritative)
      - biological_roles
      - chemical_roles
      - application_roles
      # Cross-references from all sources
      - xrefs
      # Provenance tracking
      - source_records
      - conflicts
      - last_enriched
    unique_keys:
      inchikey_cas_key:
        unique_key_slots:
          - inchikey
          - cas_rn
    id_prefixes:
      - cmm
      - CHEBI

  SourceRecord:
    description: >-
      Tracks the provenance of data from a specific source.
      Each field value can be traced back to its authoritative source.
    slots:
      - source_name
      - source_id
      - source_timestamp
      - source_query
      - source_fields

  DataConflict:
    description: >-
      Records conflicts between data sources for reconciliation review.
      Primary APIs are considered authoritative for their own ID types.
    slots:
      - field_name
      - primary_source
      - primary_value
      - conflicting_source
      - conflicting_value
      - resolution
      - resolution_notes

  # ---------------------------------------------------------------------------
  # Cross-references
  # ---------------------------------------------------------------------------

  CrossReference:
    description: A cross-reference to an external database or identifier
    slots:
      - xref_type
      - xref_id
      - xref_label
    slot_usage:
      xref_type:
        required: true
      xref_id:
        required: true

  # ---------------------------------------------------------------------------
  # Container for data
  # ---------------------------------------------------------------------------

  CMMDatabase:
    tree_root: true
    description: Container for all CMM entities
    attributes:
      ingredients:
        range: Ingredient
        multivalued: true
        inlined_as_list: true
      solutions:
        range: Solution
        multivalued: true
        inlined_as_list: true
      media:
        range: GrowthMedium
        multivalued: true
        inlined_as_list: true

# =============================================================================
# SLOTS
# =============================================================================

slots:

  # Identity slots
  id:
    identifier: true
    slot_uri: schema:identifier
    range: uriorcurie
    description: A unique identifier for a thing

  name:
    slot_uri: schema:name
    description: A human-readable name for a thing

  description:
    slot_uri: schema:description
    description: A human-readable description for a thing

  synonyms:
    multivalued: true
    description: Alternative names for this entity

  # Chemical identity slots
  chemical_formula:
    description: Chemical formula (e.g., NaCl, MgSO4Â·7H2O)

  chebi_id:
    range: uriorcurie
    description: ChEBI identifier
    id_prefixes:
      - CHEBI

  cas_rn:
    description: CAS Registry Number
    pattern: "^\\d{2,7}-\\d{2}-\\d$"

  inchikey:
    description: InChIKey for structural identification
    pattern: "^[A-Z]{14}-[A-Z]{10}-[A-Z]$"

  pubchem_cid:
    range: integer
    description: PubChem Compound ID

  # Cross-reference slots
  xrefs:
    range: CrossReference
    multivalued: true
    inlined_as_list: true
    description: Cross-references to external databases

  xref_type:
    description: Type of cross-reference (e.g., CHEBI, CAS-RN, kg-microbe-ingredient)

  xref_id:
    description: The identifier value

  xref_label:
    description: Human-readable label from the external source

  # Composition slots
  has_ingredient_component:
    range: IngredientComponent
    multivalued: true
    inlined_as_list: true
    description: Ingredients contained in this mixture with their concentrations

  has_solution_component:
    range: SolutionComponent
    multivalued: true
    inlined_as_list: true
    description: Solutions contained in this medium

  ingredient:
    range: Ingredient
    description: Reference to the ingredient entity

  solution:
    range: Solution
    description: Reference to the solution entity

  # Concentration slots
  concentration_value:
    range: float
    description: Numeric concentration value

  concentration_unit:
    range: ConcentrationUnit
    description: Unit of concentration

  volume_per_liter:
    range: float
    description: Volume of solution added per liter of medium

  volume_unit:
    range: VolumeUnit
    description: Unit of volume (typically mL)

  # Role slots
  roles:
    range: IngredientRole
    multivalued: true
    description: >-
      Functional roles of this ingredient in this specific mixture.
      An ingredient can have multiple roles, and roles are context-dependent.

  # Medium-specific slots
  medium_type:
    range: MediumType
    description: Classification of the medium

  solution_type:
    range: SolutionType
    description: Classification of the solution

  ph:
    range: float
    description: Target pH of the medium
    minimum_value: 0
    maximum_value: 14

  sterilization_method:
    description: How the medium is sterilized (e.g., autoclave, filter)

  target_organisms:
    multivalued: true
    description: Taxa or organism types this medium is designed for

  references:
    multivalued: true
    description: Literature references for this medium formulation

  notes:
    description: Free-text notes about this component

  # EnrichedIngredient-specific slots
  mediadive_id:
    range: integer
    description: MediaDive ingredient ID (MediaDive is authoritative)

  kegg_id:
    description: KEGG Compound ID (e.g., C00031)

  mesh_id:
    description: MeSH identifier

  drugbank_id:
    description: DrugBank identifier

  inchi:
    description: InChI string for structural identification

  smiles:
    description: SMILES string for structural representation

  molecular_mass:
    range: float
    description: Average molecular mass in Daltons

  monoisotopic_mass:
    range: float
    description: Monoisotopic mass in Daltons

  charge:
    range: integer
    description: Formal charge of the molecule

  biological_roles:
    multivalued: true
    description: >-
      Biological roles from ChEBI (ChEBI is authoritative).
      Examples: nutrient, metabolite, cofactor.

  chemical_roles:
    multivalued: true
    description: >-
      Chemical roles from ChEBI (ChEBI is authoritative).
      Examples: acid, base, reducing agent.

  application_roles:
    multivalued: true
    description: >-
      Application roles from ChEBI.
      Examples: drug, pesticide, food additive.

  # Provenance tracking slots
  source_records:
    range: SourceRecord
    multivalued: true
    inlined_as_list: true
    description: Records tracking which source provided which data

  conflicts:
    range: DataConflict
    multivalued: true
    inlined_as_list: true
    description: Recorded conflicts between data sources

  last_enriched:
    range: datetime
    description: Timestamp of last enrichment run

  source_name:
    description: >-
      Name of the data source (e.g., pubchem, chebi, cas, mediadive, node_normalization)

  source_id:
    description: Identifier returned by this source

  source_timestamp:
    range: datetime
    description: When this data was retrieved from the source

  source_query:
    description: The query used to retrieve data from this source

  source_fields:
    multivalued: true
    description: List of field names populated by this source

  # Conflict tracking slots
  field_name:
    description: Name of the field with conflicting values

  primary_source:
    description: The authoritative source for this field

  primary_value:
    description: Value from the authoritative source

  conflicting_source:
    description: The source with a different value

  conflicting_value:
    description: Value that conflicts with the authoritative source

  resolution:
    range: ConflictResolution
    description: How the conflict was resolved

  resolution_notes:
    description: Notes about the conflict resolution

# =============================================================================
# ENUMS
# =============================================================================

enums:

  MediumType:
    description: >-
      Classification of growth media by composition.
      Note: Functional properties like selective/differential are orthogonal
      and should be captured separately if needed.
    permissible_values:
      minimal:
        description: Defined medium with minimal components
      complex:
        description: Contains undefined components like yeast extract
      defined:
        description: All components are chemically defined
      semi_defined:
        description: Mostly defined but contains some complex components

  SolutionType:
    description: Classification of stock solutions
    permissible_values:
      trace_elements:
        description: Concentrated trace element mixture
      vitamin:
        description: Vitamin mixture
      buffer:
        description: pH buffer stock
      carbon_source:
        description: Concentrated carbon source
      other:
        description: Other type of stock solution

  IngredientRole:
    description: >-
      Functional role of an ingredient in a growth medium.
      TODO: Map to grounded ontology terms (METPO, OBI, or custom).
      See issue #11.
    permissible_values:
      carbon_source:
        description: Provides carbon for biosynthesis and/or energy
        todos:
          - Map to appropriate ontology term
      nitrogen_source:
        description: Provides nitrogen for biosynthesis
      phosphorus_source:
        description: Provides phosphorus
      sulfur_source:
        description: Provides sulfur
      trace_element:
        description: Micronutrient required in small amounts
      mineral:
        description: Macro-mineral component
      buffer:
        description: pH buffering agent
        meaning: CHEBI:35225
      vitamin:
        description: Essential vitamin or growth factor
        meaning: CHEBI:33229
      solidifying_agent:
        description: Agent for solid media (e.g., agar)
      selective_agent:
        description: Antibiotic or other selective compound
      osmotic_stabilizer:
        description: Maintains osmotic balance

  ConcentrationUnit:
    description: Units for concentration
    permissible_values:
      g_per_L:
        description: Grams per liter
        meaning: UO:0000175
      mg_per_L:
        description: Milligrams per liter
        meaning: UO:0000176
      ug_per_L:
        description: Micrograms per liter
        meaning: UO:0000301
      M:
        description: Molar
        meaning: UO:0000062
      mM:
        description: Millimolar
        meaning: UO:0000063
      uM:
        description: Micromolar
        meaning: UO:0000064
      percent_w_v:
        description: "Weight/volume percentage: % (w/v)"
      percent_v_v:
        description: "Volume/volume percentage: % (v/v)"

  VolumeUnit:
    description: Units for volume
    permissible_values:
      mL:
        description: Milliliters
        meaning: UO:0000098
      L:
        description: Liters
        meaning: UO:0000099
      uL:
        description: Microliters
        meaning: UO:0000101

  ConflictResolution:
    description: >-
      How a data conflict between sources was resolved.
      Primary APIs are considered authoritative for their own ID types.
    permissible_values:
      primary_source_wins:
        description: Primary/authoritative source value was used
      manual_review:
        description: Conflict flagged for manual review
      merged:
        description: Values were merged (e.g., for lists)
      unresolved:
        description: Conflict not yet resolved

  DataSource:
    description: >-
      Names of data sources used for enrichment.
      Each source is authoritative for its own ID type.
    permissible_values:
      pubchem:
        description: PubChem (authoritative for pubchem_cid)
      chebi:
        description: ChEBI 2.0 (authoritative for chebi_id, biological/chemical roles)
      cas:
        description: CAS Common Chemistry (authoritative for cas_rn)
      mediadive:
        description: MediaDive (authoritative for mediadive_id)
      node_normalization:
        description: NCATS Translator NodeNormalization API (identifier bridging)
      kg_microbe:
        description: KG-Microbe knowledge graph
